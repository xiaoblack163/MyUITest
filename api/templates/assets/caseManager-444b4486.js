import{m as De,i as le,p as Ie,r as s,w as ae,o as we,a as c,b as r,c as b,e as n,f,d as l,q as S,F as te,g as Ce,s as U,t as w,k as q,v as oe}from"./index-c1bbea3d.js";const xe={class:"flex align-items-center gap-3 mb-3"},ke={class:"font-semibold w-6rem"},Te={key:0,class:"flex align-items-center gap-3 mb-5"},Ne={class:"font-semibold w-6rem"},Ue={class:"flex justify-content-end gap-2"},Ae={class:"grid"},Oe={class:"col-12 md:col-3"},Se={class:"card p-fluid"},Fe=l("h5",null,"测试功能列表",-1),Ge={class:"field"},Le={class:"field"},Me={class:"flex align-items-center font-bold"},Pe=l("i",{class:"pi pi-th-large",style:{height:"1rem","margin-right":"0.5rem"}},null,-1),Be={class:"card p-fluid"},je=l("h5",null,"测试用例列表",-1),$e=["id"],qe={class:"flex align-items-center font-bold"},He=l("i",{class:"pi pi-star",style:{height:"1rem","margin-right":"0.5rem"}},null,-1),ze={class:"col-12 md:col-9"},Ee={class:"card p-fluid"},Ke=l("h5",null,"步骤编号与名称",-1),Xe=l("p",{class:"text-color-secondary block mb-5"},"请输入步骤编号与名称.",-1),Ye={class:"formgrid grid"},Je={class:"field col-12 md:col-4"},Qe={class:"field col-12 md:col-4"},Re={class:"field col-12 md:col-2"},We={class:"field col-12 md:col-2"},Ze={class:"card p-fluid"},el=l("h5",null,"定位方式与定位值",-1),ll=l("p",{class:"text-color-secondary block mb-5"},"请选择定位方式并填写定位值.",-1),al={class:"formgrid grid"},tl={class:"field col-12 md:col-5"},ol={key:0,class:"field col-12 md:col-5"},sl={key:1,class:"field col-12 md:col-5"},nl={key:0,class:"flex align-items-center"},ul=["src"],il=["src"],dl={key:1},cl={class:"flex align-items-center"},vl=["src"],rl={class:"field col-12 md:col-2"},ml={class:"card p-fluid"},pl=l("h5",null,"操作与断言",-1),fl=l("p",{class:"text-color-secondary block mb-5"},"请输入操作与断言.",-1),_l={class:"formgrid grid"},yl={class:"field col-12 md:col-5"},gl={class:"field col-12 md:col-5"},Vl={class:"field col-12 md:col-2"},hl={class:"card p-fluid"},bl={class:"formgrid grid"},Dl={class:"col-12 md:col-6"},Il={class:"card p-fluid"},wl=l("h5",null,"绝对坐标",-1),Cl={class:"formgrid grid"},xl={class:"field col"},kl=l("p",{class:"text-color-secondary block mb-5"},"请输入绝对定位坐标.",-1),Tl={class:"formgrid grid"},Nl={class:"field col"},Ul={class:"field col"},Al={class:"col-12 md:col-6"},Ol={class:"card p-fluid"},Sl=l("h5",null,"上传定位图片",-1),Fl={class:"card p-fluid"},Gl=l("h5",null,"步骤说明",-1),Ll=l("p",{class:"text-color-secondary block mb-5"},"请输入步骤说明.",-1),Bl={__name:"caseManager",setup(Ml){const se=De(),F=le("storee"),i=le("utilss"),o=Ie(),G=s(),m=s(null),H=s(),y=s(),ne=async u=>{G.value.toggle(u),H.value=await i.GetFuncTest(o)},ue=async u=>{u===null?(u={funcName:"全部功能",funcID:"全部功能"},m.value={funcName:"全部功能",funcID:"全部功能"},y.value=await i.GetCaseTests(o)):y.value=await i.GetFuncCaseTest(o,u.funcID),G.value.toggle()},v=s(null),_=s(!1),p=s(null),g=s(null),d=s(null),V=s(null),ie=[{label:"添加测试用例",icon:"pi pi-plus",command:()=>{if(console.log(event.target.outerHTML.split('<span id="')[1].split("_")[0]),event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[0]==="全部功能")return o.add({severity:"info",summary:"信息",detail:"请选择具体测试功能!",life:3e3}),!1;_.value=!0,g.value="用例",p.value="添加测试用例",v.value=event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[1]}},{label:"删除测试用例",icon:"pi pi-trash",command:()=>{if(event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[0]==="全部功能")return o.add({severity:"info",summary:"信息",detail:"请选择具体测试功能!",life:3e3}),!1;_.value=!0,g.value="用例",p.value="删除测试用例",v.value=event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[1]}},{label:"重命名测试用例",icon:"pi pi-eraser",command:()=>{if(event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[0]==="全部功能")return o.add({severity:"info",summary:"信息",detail:"请选择具体测试功能!",life:3e3}),!1;_.value=!0,g.value="用例",p.value="重命名测试用例",v.value=event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[1]}}],de=async()=>{if(!d.value)return o.add({severity:"info",summary:"信息",detail:"输入值不能为空!",life:3e3}),!1;switch(p.value){case"添加测试用例":let u=oe();console.log("添加测试用例",v.value,"输入值:",d.value),i.PostCaseTest(o,v.value,d.value,u),setTimeout(async()=>{y.value=await i.GetFuncCaseTest(o,v.value)},500);break;case"删除测试用例":console.log("删除测试用例",v.value,"输入值:",d.value),i.DeleteCaseTest(o,v.value,d.value),setTimeout(async()=>{y.value=await i.GetFuncCaseTest(o,v.value)},500);break;case"重命名测试用例":if(!V.value)return o.add({severity:"info",summary:"信息",detail:"输入值不能为空!",life:3e3}),console.log("输入值不能为空"),!1;console.log("重命名测试用例",v.value,"输入值1:",d.value,"输入值2:",V.value),i.PutCaseTest(o,v.value,d.value,V.value),setTimeout(async()=>{y.value=await i.GetFuncCaseTest(o,v.value)},500);break;case"新增功能":if(console.log("新增功能","输入值:",d.value),d.value==="全部功能")return o.add({severity:"info",summary:"信息",detail:"无法添加此功能!",life:3e3}),!1;i.PostFuncTest(o,d.value);break;case"删除功能":console.log("删除功能","输入值:",d.value),i.DeleteFuncTest(o,d.value),y.value=await i.GetCaseTests(o);break;case"重命名功能":if(!V.value)return o.add({severity:"info",summary:"信息",detail:"输入值不能为空!",life:3e3}),console.log("输入值不能为空"),!1;console.log("重命名功能","输入值1:",d.value,"输入值2:",V.value),i.PutFuncTest(o,d.value,V.value);break}},L=s(null),ce=[{label:"添加测试步骤",icon:"pi pi-plus",command:()=>{t.value={stepID:oe(),stepName:"",locatMode:"",locatValue:"",yoloValue:"",elementNumber:1,xValue:0,yValue:0,action:"",AssertOrActionValue:"",preSleep:0,stepInfo:"",caseID:event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[1],caseName:event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[0],funcID:event.target.__vueParentComponent.attrs.id.split("_")[0].split("<->")[2]},L.value="POST",console.log("添加测试步骤",t)}}],t=s({stepID:"",stepName:"",locatMode:"",locatValue:"",yoloValue:"",elementNumber:1,xValue:0,yValue:0,action:"",AssertOrActionValue:"",preSleep:0,stepInfo:"",caseID:"",funcID:""}),M=s(""),z=s(null),D=s(null),C=s(""),T=s(""),x=s(""),E=s(""),P=s(""),B=s(),K=s([]),j=s([]),ve=async(u,a,$)=>{B.value.toggle(u),K.value=await i.GetStepOrder(o,a,$)},re=async u=>{t.value=await i.GetCaseStepTest(o,u.stepID),M.value="获取步骤数据",T.value=t.value.locatMode,x.value=t.value.action,L.value="PUT",o.add({severity:"info",summary:"切换步骤",detail:u.stepName,life:3e3}),B.value.toggle(),u.value=null},me=()=>{if(t.value.locatMode=T,t.value.action=x,t.value.stepID===""||t.value.stepID===null)return o.add({severity:"error",summary:"错误",detail:"步骤ID不能为空!",life:3e3}),!1;if(t.value.caseID===""||t.value.caseID===null)return o.add({severity:"error",summary:"错误",detail:"用例ID不能为空!",life:3e3}),!1;if(t.value.funcID===""||t.value.funcID===null)return o.add({severity:"error",summary:"错误",detail:"功能ID不能为空!",life:3e3}),!1;if(t.value.stepName==="")return o.add({severity:"warn",summary:"警告",detail:"步骤名称不能为空!",life:3e3}),!1;if(t.value.locatMode==="")return o.add({severity:"warn",summary:"警告",detail:"请选择定位方式!",life:3e3}),!1;if(E.value.includes(t.value.locatMode.value)&&t.value.locatValue==="")return o.add({severity:"warn",summary:"警告",detail:"请输入定位值!",life:3e3}),!1;if(t.value.locatMode.value==="目标检测"&&t.value.yoloValue==="")return o.add({severity:"warn",summary:"警告",detail:"请选择检测目标!",life:3e3}),!1;if(t.value.action==="")return o.add({severity:"warn",summary:"警告",detail:"请选择操作或者断言!",life:3e3}),!1;if(Object.keys(P.value).includes(t.value.action.value)&&t.value.AssertOrActionValue==="")return o.add({severity:"warn",summary:"警告",detail:`请输入操作或断言参数!
`+P.value[t.value.action.value],life:3e3}),!1;if(t.value.locatMode.value==="绝对坐标"&&t.value.xValue===0&&t.value.xValue===0)return o.add({severity:"warn",summary:"警告",detail:"绝对坐标错误!",life:3e3}),!1;i.PostStepData(o,L.value,t.value)},pe=async u=>{if(t.value.stepID===""||t.value.stepID===null)return o.add({severity:"warn",summary:"警告",detail:"步骤ID不能为空!",life:3e3}),!1;{const a=new FormData;a.append("file",u.files[0]),i.uploadStepImg(o,t.value.stepID,a)}},fe=()=>{if(t.value.stepID===""||t.value.stepID===null)return o.add({severity:"warn",summary:"警告",detail:"步骤ID不能为空!",life:3e3}),!1;i.DeleteStepData(o,t.value.stepID)},_e=u=>{se.require({target:u.currentTarget,message:"删除步骤?",icon:"pi pi-info-circle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"取消",acceptLabel:"确认",accept:()=>{fe()},reject:()=>{console.log("取消")}})},I=s(!1),h=s(!1),X=s([]);ae(T,u=>{M.value==="切换定位方式"&&(x.value="",t.value.AssertOrActionValue="",t.value.locatValue="",t.value.yoloValue=""),u.value==="无需定位"?(D.value=C.value.无需定位,I.value=!0,h.value=!1):["文本","ID","XPATH","CSS","自定义"].includes(u.value)?(D.value=C.value.标签定位,I.value=!1,h.value=!1):u.value==="文字识别"?(D.value=C.value.坐标定位,I.value=!1,h.value=!1):["绝对坐标","图像识别"].includes(u.value)?(D.value=C.value.坐标定位,I.value=!0,h.value=!1):u.value==="目标检测"?(D.value=C.value.坐标定位,I.value=!0,h.value=!0):(D.value="",I.value=!1,h.value=!1)});const A=s(!1),Y=s([]);return ae(x,u=>{u.value==="动作链:按键"?A.value=!0:A.value=!1}),we(async()=>{m.value={funcName:"全部功能",funcID:"全部功能"},y.value=await i.GetCaseTests(o),z.value=await i.initLocation(o),C.value=await i.initAction(o),P.value=await i.checkActionValue(o),E.value=await i.checkLocatValue(o),X.value=await i.GetYoloOption(),Y.value=await i.GetKeyOption()}),(u,a)=>{const $=c("ConfirmPopup"),N=c("InputText"),k=c("Button"),ye=c("Dialog"),J=c("Listbox"),Q=c("OverlayPanel"),ge=c("ButtonGroup"),R=c("SplitButton"),W=c("CascadeSelect"),Ve=c("Image"),Z=c("Dropdown"),O=c("InputNumber"),ee=c("Textarea"),he=c("FileUpload");return r(),b(te,null,[n($),n(ye,{visible:_.value,"onUpdate:visible":a[3]||(a[3]=e=>_.value=e),modal:"",header:p.value,style:{width:"25rem"}},{default:f(()=>[l("div",xe,[l("label",ke,w(g.value)+"名",1),n(N,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value=e),class:"flex-auto",autocomplete:"off"},null,8,["modelValue"])]),p.value==="重命名测试用例"||p.value==="重命名功能"?(r(),b("div",Te,[l("label",Ne,"新"+w(g.value)+"名",1),n(N,{modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value=e),class:"flex-auto",autocomplete:"off"},null,8,["modelValue"])])):U("",!0),l("div",Ue,[n(k,{type:"button",label:"确认",onClick:a[2]||(a[2]=e=>{de(),_.value=!1})})])]),_:1},8,["visible","header"]),n(Q,{ref_key:"op",ref:B},{default:f(()=>[n(J,{modelValue:j.value,"onUpdate:modelValue":a[4]||(a[4]=e=>j.value=e),onChange:a[5]||(a[5]=e=>re(j.value)),filter:"",options:K.value,optionLabel:"stepName",class:"w-full md:w-14rem"},null,8,["modelValue","options"])]),_:1},512),n(Q,{ref_key:"op2",ref:G},{default:f(()=>[n(J,{modelValue:m.value,"onUpdate:modelValue":a[6]||(a[6]=e=>m.value=e),onChange:a[7]||(a[7]=e=>ue(m.value)),filter:"",options:H.value,optionLabel:"funcName",class:"w-full md:w-14rem"},null,8,["modelValue","options"])]),_:1},512),l("div",Ae,[l("div",Oe,[l("div",Se,[Fe,l("div",Ge,[n(ge,null,{default:f(()=>[n(k,{onClick:a[8]||(a[8]=e=>{_.value=!0,p.value="新增功能",g.value="功能"}),text:"",icon:"pi pi-plus"}),n(k,{onClick:a[9]||(a[9]=e=>{_.value=!0,p.value="删除功能",g.value="功能"}),text:"",icon:"pi pi-trash"}),n(k,{onClick:a[10]||(a[10]=e=>{_.value=!0,p.value="重命名功能",g.value="功能"}),text:"",icon:"pi pi-eraser"})]),_:1})]),l("div",Le,[(r(),S(R,{model:ie,onClick:a[11]||(a[11]=e=>ne(e)),key:m.value.funcID,myid:m.value.funcName+"<->"+m.value.funcID,id:m.value.funcName+"<->"+m.value.funcID},{default:f(()=>[l("span",Me,[Pe,l("span",null,w(m.value.funcName),1)])]),_:1},8,["myid","id"]))])]),l("div",Be,[je,(r(!0),b(te,null,Ce(y.value,e=>(r(),b("div",{key:e.caseID,id:e.caseName+"<->"+e.caseID+"<->"+e.funcID,class:"field"},[(r(),S(R,{model:ce,onClick:be=>ve(be,e.funcID,e.caseID),key:e.caseID,id:e.caseName+"<->"+e.caseID+"<->"+e.funcID},{default:f(()=>[l("span",qe,[He,l("span",null,w(e.caseName),1)])]),_:2},1032,["onClick","id"]))],8,$e))),128))])]),l("div",ze,[l("div",Ee,[Ke,Xe,l("div",Ye,[l("div",Je,[n(N,{disabled:"",modelValue:t.value.stepID,"onUpdate:modelValue":a[12]||(a[12]=e=>t.value.stepID=e),id:"lastname1",style:{width:"100%"},type:"text",placeholder:"请输入步骤编号"},null,8,["modelValue"])]),l("div",Qe,[n(N,{id:"lastname1",modelValue:t.value.stepName,"onUpdate:modelValue":a[13]||(a[13]=e=>t.value.stepName=e),style:{width:"100%"},type:"text",placeholder:"请输入步骤名称"},null,8,["modelValue"])]),l("div",Re,[n(k,{label:"保存",onClick:me})]),l("div",We,[n(k,{onClick:a[14]||(a[14]=e=>_e(e)),label:"删除",outlined:""})])])]),l("div",Ze,[el,ll,l("div",al,[l("div",tl,[n(W,{onChange:a[15]||(a[15]=e=>M.value="切换定位方式"),modelValue:T.value,"onUpdate:modelValue":a[16]||(a[16]=e=>T.value=e),options:z.value,style:{width:"100%"},optionLabel:"value",optionGroupLabel:"value",optionGroupChildren:["states"],placeholder:"请选择定位方式"},null,8,["modelValue","options"])]),h.value?U("",!0):(r(),b("div",ol,[n(N,{disabled:I.value,id:"lastname1",modelValue:t.value.locatValue,"onUpdate:modelValue":a[17]||(a[17]=e=>t.value.locatValue=e),style:{width:"100%"},type:"text",placeholder:"请输入定位值"},null,8,["disabled","modelValue"])])),h.value?(r(),b("div",sl,[n(Z,{modelValue:t.value.yoloValue,"onUpdate:modelValue":a[18]||(a[18]=e=>t.value.yoloValue=e),options:X.value,placeholder:"请选择检测目标"},{value:f(e=>[e.value?(r(),b("div",nl,[n(Ve,{alt:"Image",preview:""},{image:f(()=>[l("img",{src:q(F).host+"/yoloImages/"+e.value+".jpg",alt:"",width:"18"},null,8,ul)]),preview:f(()=>[l("img",{src:q(F).host+"/yoloImages/"+e.value+".jpg",alt:"",width:"500"},null,8,il)]),_:2},1024),l("div",null,w(e.value),1)])):(r(),b("span",dl,w(e.placeholder),1))]),option:f(e=>[l("div",cl,[l("img",{alt:"",src:q(F).host+"/yoloImages/"+e.option+".jpg",style:{width:"18px"}},null,8,vl),l("div",null,w(e.option),1)])]),_:1},8,["modelValue","options"])])):U("",!0),l("div",rl,[n(O,{modelValue:t.value.elementNumber,"onUpdate:modelValue":a[19]||(a[19]=e=>t.value.elementNumber=e),inputId:"minmax-buttons",placeholder:"元素序号",mode:"decimal",showButtons:"",min:1,max:100},null,8,["modelValue"])])])]),l("div",ml,[pl,fl,l("div",_l,[l("div",yl,[n(W,{modelValue:x.value,"onUpdate:modelValue":a[20]||(a[20]=e=>x.value=e),options:D.value,style:{width:"100%"},optionLabel:"value",optionGroupLabel:"value",optionGroupChildren:["states"],placeholder:"请选择操作与断言"},null,8,["modelValue","options"])]),l("div",gl,[A.value?U("",!0):(r(),S(ee,{key:0,modelValue:t.value.AssertOrActionValue,"onUpdate:modelValue":a[21]||(a[21]=e=>t.value.AssertOrActionValue=e),placeholder:"请输入操作或断言参数",style:{height:"50%"}},null,8,["modelValue"])),A.value?(r(),S(Z,{key:1,modelValue:t.value.AssertOrActionValue,"onUpdate:modelValue":a[22]||(a[22]=e=>t.value.AssertOrActionValue=e),options:Y.value,placeholder:"请选择按键"},null,8,["modelValue","options"])):U("",!0)]),l("div",Vl,[n(O,{modelValue:t.value.preSleep,"onUpdate:modelValue":a[23]||(a[23]=e=>t.value.preSleep=e),inputId:"minmax-buttons",placeholder:"执行前等待时间",mode:"decimal",showButtons:"",min:0,max:100},null,8,["modelValue"])])])]),l("div",hl,[l("div",bl,[l("div",Dl,[l("div",Il,[wl,l("div",Cl,[l("div",xl,[kl,l("div",Tl,[l("div",Nl,[n(O,{modelValue:t.value.xValue,"onUpdate:modelValue":a[24]||(a[24]=e=>t.value.xValue=e),placeholder:"请输入x坐标",min:-1920,max:1920},null,8,["modelValue"])]),l("div",Ul,[n(O,{modelValue:t.value.yValue,"onUpdate:modelValue":a[25]||(a[25]=e=>t.value.yValue=e),placeholder:"请输入y坐标",min:-1080,max:1080},null,8,["modelValue"])])])])])])]),l("div",Al,[l("div",Ol,[Sl,n(he,{name:"demo[]",showCancelButton:!1,showUploadButton:!1,fileLimit:1,onSelect:a[26]||(a[26]=e=>pe(e)),accept:"image/*",maxFileSize:1e6,customUpload:""})])])])]),l("div",Fl,[Gl,Ll,n(ee,{modelValue:t.value.stepInfo,"onUpdate:modelValue":a[27]||(a[27]=e=>t.value.stepInfo=e),id:"address",rows:"4"},null,8,["modelValue"])])])])],64)}}};export{Bl as default};
